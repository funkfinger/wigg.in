I"é<p>This could undoubtedly be more elegant, but itâ€™s late and I want it to work now. May take another stab at it laterâ€¦</p>

<p><strong>TODO:</strong> limit the content types and only allow rendering if they are ok.</p>

<p>Setting up a before filter:</p>

<pre lang="ruby" line="1">
before do
  # remove and grab the file extension
  request.path_info.sub! %r{\.([^\./]+)$}, ''
  @format=$1 || 'html'
  @charset=mime_type($1) || 'text/html'
  content_type @charset, :charset =&gt; 'utf-8'
end
</pre>

<p>and using a case statement:</p>

<pre lang="ruby" line="1">
get "/home" do
  case @format
  when 'html'
    @stylesheet='home.css'
    haml :home, :layout=&gt;:layout_simple
  when 'js'
    "{'js':true}"
  else
    pass
  end
end
</pre>
:ET